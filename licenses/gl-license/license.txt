This code is under Apache License, version 2.0 (2004). Authors: Gilles Landel